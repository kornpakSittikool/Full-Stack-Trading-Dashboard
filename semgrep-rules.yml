rules:
  - id: detect-eval-usage
    pattern-either:
      - pattern: eval($X)
    message: "Avoid using eval() as it may introduce security vulnerabilities."
    severity: ERROR
    languages: [javascript ,typescript]

  - id: detect-function-usage
    patterns-either:
      - pattern: someUnsafeFunction($X)
    message: "Detected the use of a potentially unsafe function. Check if this function poses any security risks."
    severity: WARNING
    languages: [javascript ,typescript]
  
  - id: detect-hardcoded-secret
    patterns-either:
      - pattern: $KEY = "$SECRET"
      - pattern-inside: |
          const $KEY = "$SECRET"
    message: "Detected hardcoded secrets (such as API keys or passwords) in the code."
    severity: ERROR
    languages: [javascript ,typescript]
  
  - id: detect-insecure-endpoint
    patterns-either:
      - pattern: "http://$X"
    message: "Detected an insecure endpoint (HTTP). It is recommended to use HTTPS instead."
    severity: ERROR
    languages: [javascript ,typescript]
  
  - id: detect-sensitive-logging
    patterns-either:
      - pattern: console.log($X)
    message: "Detected logging of potentially sensitive information. Ensure that the logged data is safe."
    severity: WARNING
    languages: [javascript ,typescript]
  
  - id: detect-unsafe-regular-expressions
    patterns-either:
      - pattern: /(.+)+/
    message: "Detected a regular expression that could lead to ReDoS (Regular Expression Denial of Service)."
    severity: WARNING
    languages: [javascript ,typescript]
  
  - id: detect-unvalidated-input
    patterns-either:
      - pattern: req.body.$INPUT
    message: "Detected unvalidated user input, which may lead to security vulnerabilities."
    severity: WARNING
    languages: [javascript ,typescript]
  
  - id: duplicate-code
    pattern-either: |
      def $FUNC_NAME($ARGS):
          $BODY
      def $FUNC_NAME($ARGS):
          $BODY
    message: "Duplicated function definition detected."
    severity: WARNING
  
  - id: long-function
    pattern-either: |
      def $FUNC_NAME($ARGS):
          $BODY
    message: "Function is too long. Consider refactoring."
    severity: WARNING
    max-lines: 20
    languages: [javascript, typescript]
  
  - id: complex-if-else
    pattern-either: |
      if $COND1:
          $BODY1
      else:
          if $COND2:
              $BODY2
          else:
              $BODY3
    message: "Complex if-else statement detected. Consider refactoring."
    severity: WARNING
    languages: [javascript, typescript]
  
  - id: duplicate-loop
    pattern-either: |
      for $VAR in $COLLECTION:
          $BODY
      for $VAR in $COLLECTION:
          $BODY
    message: "Duplicated loop detected. Consider refactoring."
    severity: WARNING
    languages: [javascript, typescript]
  
  - id: hardcoded-value
    pattern-either: |
      $VAR = "secret"
    message: "Avoid using hardcoded values in the code."
    severity: ERROR
    languages: [javascript, typescript]
